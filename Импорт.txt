&НаСервере
Процедура ОбработатьФайл(ВыбранноеИмяФайла)
    Попытка
        // 1. Чтение файла в табличный документ
        ТабДок = Новый ТабличныйДокумент;
        ТабДок.Прочитать(ВыбранноеИмяФайла, СпособЧтенияЗначенийТабличногоДокумента.Значение);
        
        // 2. Извлечение данных из именованной области
        Область = ТабДок.Область("Фурнитура");
        
        // 3. Создание таблицы значений с нужными колонками
        Таблица = Новый ТаблицаЗначений;
        Колонки = "Наименование,Артикул,Ширина,Длина,Тип,Цена,Вес";
        Для Каждого ИмяКолонки Из СтрРазделить(Колонки, ",") Цикл
            Таблица.Колонки.Добавить(ИмяКолонки);
        КонецЦикла;
        
        // 4. Перенос данных из области в таблицу значений
        Для Сч = 1 По Область.Высота - 1 Цикл
            Строка = Таблица.Добавить();
            Для Кол = 0 По 6 Цикл
                Строка[Кол] = Область.Ячейка(Сч, Кол).Текст;
            КонецЦикла;
        КонецЦикла;
        
        // 5. Создание элементов справочника
        Для Каждого Строка Из Таблица Цикл
            Если Не ЗначениеЗаполнено(Строка.Наименование) Тогда Продолжить КонецЕсли;
            
            НовЭлемент = Справочники.Фурнитура.СоздатьЭлемент();
            НовЭлемент.Наименование = Строка.Наименование;
            НовЭлемент.Артикул     = Строка.Артикул;
            НовЭлемент.Ширина      = Число(Строка.Ширина);
            НовЭлемент.Длина       = Число(Строка.Длина);
            НовЭлемент.Тип         = Строка.Тип;
            НовЭлемент.Цена        = Число(Строка.Цена);
            НовЭлемент.Вес         = Число(Строка.Вес);
            НовЭлемент.Записать();
        КонецЦикла;
        
        // 6. Уведомление о результате
        Сообщить("Загружено элементов: " + Таблица.Количество());
    Исключение
        Сообщить("Ошибка: " + ОписаниеОшибки());
    КонецПопытки;
КонецПроцедуры

&НаКлиенте
Процедура ЗагрузкаДанных(Команда)
    // Инициируем выбор файла
    НачатьПомещениеФайла(Новый ОписаниеОповещения("ВыборФайла", ЭтотОбъект));
КонецПроцедуры

&НаКлиенте
Процедура ВыборФайла(Результат, Адрес, ИмяФайла, Параметр) Экспорт
    // Передача обработки на сервер
    ОбработатьФайл(ИмяФайла);
КонецПроцедуры